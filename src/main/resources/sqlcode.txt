CREATE DATABASE CAR_FACTORY;

CREATE TABLE car_body
(
    id   INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    type VARCHAR(65) NOT NULL
);

INSERT INTO car_body (type)
VALUES ('HATCHBACK'),
       ('SEDAN'),
       ('CROSSOVER');

CREATE TABLE car_wheel
(
    id   INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    wheel_size VARCHAR(65) NOT NULL
);

INSERT INTO car_wheel (wheel_size)
VALUES ('R15'),
       ('R16'),
       ('R17');

CREATE TABLE car
(
    id   INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    cool_name   VARCHAR(65)                      NOT NULL,
    car_body_id INTEGER REFERENCES car_body (id) NOT NULL,
    CONSTRAINT fk_car_body FOREIGN KEY (car_body_id) REFERENCES car_body (id)
);

CREATE TABLE car_wheels
(
    car_id       INTEGER REFERENCES car (id)       NOT NULL,
    car_wheel_id INTEGER REFERENCES car_wheel (id) NOT NULL,
    PRIMARY KEY (car_id, car_wheel_id),
    CONSTRAINT fk_car FOREIGN KEY (car_id) REFERENCES car (id),
    CONSTRAINT fk_car_wheel FOREIGN KEY (car_wheel_id) REFERENCES car_wheel (id)
);

ALTER TABLE car_body
ADD COLUMN quantity INT DEFAULT 5;

ALTER TABLE car_wheels
ADD COLUMN quantity INT DEFAULT 10;
